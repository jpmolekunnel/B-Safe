---
 - name: Copy war file and Docker file
   hosts: node.AetnaHealthcare.com
   become: yes
   tasks:

     - name: Create Directory
       file:
         path: /home/ubuntu/Docker-Work
         state: directory
         owner: root
         group: root
         mode: '0755'

     - name: Copy War file
       shell: cp -r /home/jenkins/workspace/B-Safe/target/AetnaHealthCareUsers-1.0.war /home/ubuntu/Docker-Work/

     - name: Copy Dockerfile
       template: 
         src: Dockerfile
         dest: "/home/ubuntu/Docker-Work/Dockerfile"
     
     - name: Build Container Image
       shell: sudo docker build -t aetnahealthcareusers:latest /home/ubuntu/Docker-Work/
       register: container_status

     - debug:
         var: container_status.stdout_lines
